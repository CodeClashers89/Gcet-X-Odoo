{% extends 'base.html' %}

{% block title %}Two-Factor Authentication - Rental ERP{% endblock %}

{% block content %}
<div style="max-width: 450px; margin: 60px auto; background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
    <div style="text-align: center; margin-bottom: 30px;">
        <div style="width: 80px; height: 80px; background: #2196F3; border-radius: 50%; display: inline-flex; align-items: center; justify-content: center; margin-bottom: 20px;">
            <span style="font-size: 40px; color: white;">üîí</span>
        </div>
        <h1 style="color: #2c3e50; margin-bottom: 10px; font-size: 24px;">Verify Your Identity</h1>
        <p style="color: #6c757d; margin: 0;">
            Enter the 6-digit code from your authenticator app
        </p>
    </div>

    <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px; text-align: center;">
        <p style="margin: 0; font-size: 13px; color: #666;">Logging in as:</p>
        <p style="margin: 5px 0 0 0; font-weight: 600; color: #333;">{{ email }}</p>
    </div>

    <form method="POST">
        {% csrf_token %}
        
        <div class="form-group" style="margin-bottom: 20px;">
            <label for="token" style="display: block; margin-bottom: 8px; font-weight: 500;">
                Verification Code
            </label>
            <input 
                type="text" 
                id="token"
                name="token"
                class="form-control"
                placeholder="000000"
                required
                maxlength="6"
                pattern="[0-9]{6}"
                autofocus
                style="font-size: 32px; text-align: center; letter-spacing: 12px; font-family: monospace; padding: 15px;"
                autocomplete="off"
            >
            <small style="color: #6c757d; font-size: 12px; display: block; margin-top: 8px;">
                Open your authenticator app to get the code
            </small>
        </div>

        <button type="submit" class="btn btn-primary" style="width: 100%; padding: 12px; font-size: 16px;">
            Verify & Login
        </button>
    </form>

    <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #dee2e6; text-align: center;">
        <p style="color: #6c757d; font-size: 13px; margin: 0 0 10px 0;">
            Lost your device?
        </p>
        <p style="color: #6c757d; font-size: 13px; margin: 0;">
            Use one of your backup codes instead of the generated code.
        </p>
    </div>

    <div style="margin-top: 20px; text-align: center;">
        <a href="{% url 'login' %}" style="color: #2196F3; text-decoration: none; font-size: 14px;">
            ‚Üê Back to Login
        </a>
    </div>
</div>

<script>
// Auto-submit form when 6 digits are entered
document.getElementById('token').addEventListener('input', function(e) {
    if (e.target.value.length === 6) {
        // Small delay for better UX
        setTimeout(() => {
            e.target.form.submit();
        }, 300);
    }
});

// Auto-format: only allow numbers
document.getElementById('token').addEventListener('keypress', function(e) {
    if (!/[0-9]/.test(e.key) && e.key !== 'Backspace' && e.key !== 'Delete') {
        e.preventDefault();
    }
});
</script>
{% endblock %}
